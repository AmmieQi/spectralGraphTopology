library(extrafont)
library(latex2exp)
ratios <- c(1000, 2000, 4000, 8000)
n_ratios <- c(1:length(ratios))

rel_err_sgl   <- readRDS(file = "rel_err_sgl.rds")
rel_err_cgl   <- readRDS(file = "rel_err_cgl.rds")
rel_err_naive <- readRDS(file = "rel_err_naive.rds")
rel_err_qp    <- readRDS(file = "rel_err_qp.rds")
rel_err_pavez <- readRDS(file = "rel_err_pavez.rds")

fscore_sgl    <- readRDS(file = "fscore_sgl.rds")
fscore_naive  <- readRDS(file = "fscore_naive.rds")
fscore_qp     <- readRDS(file = "fscore_qp.rds")
fscore_cgl    <- readRDS(file = "fscore_cgl.rds")
fscore_pavez  <- readRDS(file = "fscore_pavez.rds")

recall_sgl    <- readRDS(file = "recal_sgl.rds")
recall_naive  <- readRDS(file = "recal_naive.rds")
recall_qp     <- readRDS(file = "recal_qp.rds")
recall_cgl    <- readRDS(file = "recal_cgl.rds")
recall_pavez  <- readRDS(file = "recal_pavez.rds")

specificity_sgl   <- readRDS(file = "specificity_sgl.rds")
specificity_naive <- readRDS(file = "specificity_naive.rds")
specificity_qp    <- readRDS(file = "specificity_qp.rds")
specificity_cgl   <- readRDS(file = "specificity_cgl.rds")
specificity_pavez <- readRDS(file = "specificity_pavez.rds")

accuracy_sgl   <- readRDS(file = "accuracy_sgl.rds")
accuracy_naive <- readRDS(file = "accuracy_naive.rds")
accuracy_qp    <- readRDS(file = "accuracy_qp.rds")
accuracy_cgl   <- readRDS(file = "accuracy_cgl.rds")
accuracy_pavez <- readRDS(file = "accuracy_pavez.rds")

colors <- c("#0B032D", "#843B62", "#F67E7D", "#706fd3", "#6ABA81")
pch <- c(15, 7, 8, 11, 9)
lty <- c(1, 1, 1, 1, 1)
legend <- c("Naive", "QP", "CGL", "Pavez", "SGL (proposed)")
xlab <- TeX("$\\mathit{m} / \\mathit{n}$")
gr = .5 * (1 + sqrt(5))
setEPS()
postscript("../latex/figures/relative_error_bipartite.ps", family = "ComputerModern", height = 5, width = gr * 3.5)
plot(n_ratios, rel_err_naive, type = "b", lty = lty[1], pch=pch[1], cex=.75, ylim=c(0, .9),
     xlab = xlab, ylab = "Average Relative Error", col = colors[1], xaxt = "n")
grid()
lines(n_ratios, rel_err_qp,   type = "b", lty=lty[2], pch=pch[2], cex=.75, col = colors[2], xaxt = "n")
lines(n_ratios, rel_err_cgl,  type = "b", lty=lty[3], pch=pch[3], cex=.75, col = colors[3], xaxt = "n")
lines(n_ratios, rel_err_pavez,type = "b", lty=lty[4], pch=pch[4], cex=.75, col = colors[4], xaxt = "n")
lines(n_ratios, rel_err_sgl,  type = "b", lty=lty[5], pch=pch[5], cex=.75, col = colors[5], xaxt = "n")
axis(side = 1, at = n_ratios, labels = ratios)
legend("topright", legend=legend, col=colors, pch=pch, lty=lty, bty="n")
dev.off()
embed_fonts("../latex/figures/relative_error_bipartite.ps", outfile="../latex/figures/relative_error_bipartite.ps")
setEPS()
postscript("../latex/figures/fscore_bipartite.ps", family = "ComputerModern", height = 5, width = gr * 3.5)
plot(n_ratios, fscore_naive, ylim=c(.5, 1.), xlab = xlab, ylab = "Average F-score", type = "b",
     pch=pch[1], lty=lty[1], cex=.75, col = colors[1], xaxt = "n")
grid()
lines(n_ratios, fscore_qp,   type = "b", lty=lty[2], pch=pch[2], cex=.75, col = colors[2], xaxt = "n")
lines(n_ratios, fscore_cgl,  type = "b", lty=lty[3], pch=pch[3], cex=.75, col = colors[3], xaxt = "n")
lines(n_ratios, fscore_pavez, type = "b",lty=lty[4], pch=pch[4], cex=.75, col = colors[4], xaxt = "n")
lines(n_ratios, fscore_sgl, type = "b",  lty=lty[5], pch=pch[5], cex=.75, col = colors[5], xaxt = "n")
axis(side = 1, at = n_ratios, labels = ratios)
legend("bottomright", legend=legend, col=colors, pch=pch, lty=lty, bty="n")
dev.off()
embed_fonts("../latex/figures/fscore_bipartite.ps", outfile="../latex/figures/fscore_bipartite.ps")
